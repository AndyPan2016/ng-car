var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Nevm;!function(t){function e(t){return void 0===t}function r(t){return!("object"!=typeof t||null===t||Array.isArray(t)||t instanceof RegExp||t instanceof Date)}t.isArray=function(t){return Array.isArray?Array.isArray(t):!(!t||"number"!=typeof t.length||t.constructor!==Array)},t.isString=function(t){return"string"==typeof t||t instanceof String},t.isBoolean=function(t){return!0===t||!1===t},t.isNumber=function(t){return("number"==typeof t||t instanceof Number)&&!isNaN(t)},t.isFunction=function(t){return"function"==typeof t},t.isUndefined=e,t.isUndefinedOrNull=function(t){return e(t)||null===t},t.isObject=r;var n=Object.prototype.hasOwnProperty;t.isEmptyObject=function(t){if(!r(t))return!1;for(var e in t)if(n.call(t,e))return!1;return!0}}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(t){return-1!==a.indexOf(t)}function r(){return!!i&&/ip(ad|hone|od)/.test(a)}function n(){return!!i&&e("android")}t.unzip=function(t){return 31===t[0]&&139===t[1]?pako.ungzip(t):t};var i="undefined"!=typeof navigator,s=i&&!!navigator.userAgent.match(/Trident\/7\./),o=i&&!!navigator.userAgent.match(/Edge/),a=i?navigator.userAgent.toLowerCase():"",u="undefined"!=typeof self&&"undefined"==typeof window;t.isTouchDevice=function(){return"undefined"!=typeof window&&"ontouchstart"in window},t.isIOS=r,t.isAndroid=n,t.isSafari=function(){return!!i&&e("safari")&&!e("chrome")},t.isFireFox=function(){return!!i&&e("firefox")},t.isMobile=function(){return!!i&&(n()||r())},t.isMac=function(){return!!i&&e("mac os")},t.isWindows=function(){return!!i&&(e("win32")||e("windows"))},t.isInWorker=function(){return u},t.isIE=function(){return s||o},t.noop=function(){};var h=Object.create,c=Object.prototype.hasOwnProperty;t.createDictionary=function(t){var e=h(null);e.__=void 0,delete e.__;for(var r in t)c.call(t,r)&&(e[r]=t[r]);return e}}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";var e=function(){function e(){this.log=t.noop,this.info=t.noop,this.warn=t.noop,this.debug=t.noop,this.error=t.noop}return Object.defineProperty(e.prototype,"level",{set:function(e){this.debug=e>=1?console.debug.bind(console):t.noop,this.log=e>=2?console.log.bind(console):t.noop,this.info=e>=3?console.info.bind(console):t.noop,this.warn=e>=4?console.warn.bind(console):t.noop,this.error=e>=5?console.error.bind(console):t.noop},enumerable:!0,configurable:!0}),e}();t.logger=new e}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(){void 0===i&&(i=t.createMatrix4())}function r(){void 0===s&&(s=new a)}function n(){void 0===o&&(o=new a)}t.createVector3=function(t,e,r){return new a(t,e,r)},t.isVector3Class=function(t){return t instanceof a};var i,s,o,a=function(){function t(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0}return t.prototype.set=function(t,e,r){return this.x=t,this.y=e,this.z=r,this},t.prototype.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},t.prototype.setX=function(t){return this.x=t,this},t.prototype.setY=function(t){return this.y=t,this},t.prototype.setZ=function(t){return this.z=t,this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index of out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index of out of range: "+t)}},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},t.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},t.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},t.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},t.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},t.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},t.prototype.multiplyScalar=function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},t.prototype.multiplyVectors=function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},t.prototype.applyMatrix3=function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6]*n,this.y=i[1]*e+i[4]*r+i[7]*n,this.z=i[2]*e+i[5]*r+i[8]*n,this},t.prototype.applyMatrix4=function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[4]*r+i[8]*n+i[12],this.y=i[1]*e+i[5]*r+i[9]*n+i[13],this.z=i[2]*e+i[6]*r+i[10]*n+i[14],this},t.prototype.applyProjection=function(t){var e=this.x,r=this.y,n=this.z,i=t.elements,s=1/(i[3]*e+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*e+i[4]*r+i[8]*n+i[12])*s,this.y=(i[1]*e+i[5]*r+i[9]*n+i[13])*s,this.z=(i[2]*e+i[6]*r+i[10]*n+i[14])*s,this},t.prototype.applyQuaternion=function(t){var e=this.x,r=this.y,n=this.z,i=t.x,s=t.y,o=t.z,a=t.w,u=a*e+s*n-o*r,h=a*r+o*e-i*n,c=a*n+i*r-s*e,p=-i*e-s*r-o*n;return this.x=u*a+p*-i+h*-o-c*-s,this.y=h*a+p*-s+c*-i-u*-o,this.z=c*a+p*-o+u*-s-h*-i,this},t.prototype.project=function(t){return e(),i.multiplyMatrices(t.projectionMatrix,i.getInverse(t.matrixWorld)),this.applyProjection(i)},t.prototype.unproject=function(t){return e(),i.multiplyMatrices(t.matrixWorld,i.getInverse(t.projectionMatrix)),this.applyProjection(i)},t.prototype.transformDirection=function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[4]*r+i[8]*n,this.y=i[1]*e+i[5]*r+i[9]*n,this.z=i[2]*e+i[6]*r+i[10]*n,this.normalize()},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},t.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},t.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},t.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},t.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},t.prototype.clampScalar=function(t,e){return r(),n(),s.set(t,t,t),o.set(e,e,e),this.clamp(s,o)},t.prototype.clampLength=function(t,e){var r=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,r))/r)},t.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},t.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},t.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.lengthManhattan=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},t.prototype.normalize=function(){return this.divideScalar(this.length())},t.prototype.setLength=function(t){return this.multiplyScalar(t/this.length())},t.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},t.prototype.lerpVectors=function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t)},t.prototype.cross=function(t){var e=this.x,r=this.y,n=this.z;return this.x=r*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-r*t.x,this},t.prototype.crossVectors=function(t,e){var r=t.x,n=t.y,i=t.z,s=e.x,o=e.y,a=e.z;return this.x=n*a-i*o,this.y=i*s-r*a,this.z=r*o-n*s,this},t.prototype.projectOnVector=function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},t.prototype.projectOnPlane=function(t){return r(),s.copy(this).projectOnVector(t),this.sub(s)},t.prototype.reflect=function(t){return r(),this.sub(s.copy(t).multiplyScalar(2*this.dot(t)))},t.prototype.angleTo=function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Math.max(-1,Math.min(1,e)))},t.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},t.prototype.distanceToSquared=function(t){var e=this.x-t.x,r=this.y-t.y,n=this.z-t.z;return e*e+r*r+n*n},t.prototype.distanceToManhattan=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},t.prototype.setFromMatrixPosition=function(t){return this.setFromMatrixColumn(t,3)},t.prototype.setFromMatrixScale=function(t){var e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=n,this},t.prototype.setFromMatrixColumn=function(t,e){return this.fromArray(t.elements,4*e)},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},t}()}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(){void 0===i&&(i=t.createVector3())}function r(){void 0===s&&(void 0===i&&(i=t.createVector3()),s=t.createVector3(),o=t.createVector3())}function n(){void 0===a&&(a=new u)}t.createMatrix4=function(t){return new u(t)},t.isMatrix4Class=function(t){return t instanceof u};var i,s,o,a,u=function(){function u(t){this.elements=t?new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return u.prototype.set=function(t,e,r,n,i,s,o,a,u,h,c,p,l,f,y,d){var m=this.elements;return m[0]=t,m[4]=e,m[8]=r,m[12]=n,m[1]=i,m[5]=s,m[9]=o,m[13]=a,m[2]=u,m[6]=h,m[10]=c,m[14]=p,m[3]=l,m[7]=f,m[11]=y,m[15]=d,this},u.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},u.prototype.clone=function(){return(new u).fromArray(this.elements)},u.prototype.copy=function(t){return this.elements.set(t.elements),this},u.prototype.copyPosition=function(t){var e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this},u.prototype.extractBasis=function(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},u.prototype.makeBasis=function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},u.prototype.extractRotation=function(t){e();var r=this.elements,n=t.elements,s=1/i.setFromMatrixColumn(t,0).length(),o=1/i.setFromMatrixColumn(t,1).length(),a=1/i.setFromMatrixColumn(t,2).length();return r[0]=n[0]*s,r[1]=n[1]*s,r[2]=n[2]*s,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,this},u.prototype.makeRotationFromEuler=function(t){var e=this.elements,r=t.x,n=t.y,i=t.z,s=Math.cos(r),o=Math.sin(r),a=Math.cos(n),u=Math.sin(n),h=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var p=s*h,l=s*c,f=o*h,y=o*c;e[0]=a*h,e[4]=-a*c,e[8]=u,e[1]=l+f*u,e[5]=p-y*u,e[9]=-o*a,e[2]=y-p*u,e[6]=f+l*u,e[10]=s*a}else if("YXZ"===t.order){var d=a*h,m=a*c,v=u*h,x=u*c;e[0]=d+x*o,e[4]=v*o-m,e[8]=s*u,e[1]=s*c,e[5]=s*h,e[9]=-o,e[2]=m*o-v,e[6]=x+d*o,e[10]=s*a}else if("ZXY"===t.order){var d=a*h,m=a*c,v=u*h,x=u*c;e[0]=d-x*o,e[4]=-s*c,e[8]=v+m*o,e[1]=m+v*o,e[5]=s*h,e[9]=x-d*o,e[2]=-s*u,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){var p=s*h,l=s*c,f=o*h,y=o*c;e[0]=a*h,e[4]=f*u-l,e[8]=p*u+y,e[1]=a*c,e[5]=y*u+p,e[9]=l*u-f,e[2]=-u,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){var g=s*a,b=s*u,w=o*a,z=o*u;e[0]=a*h,e[4]=z-g*c,e[8]=w*c+b,e[1]=c,e[5]=s*h,e[9]=-o*h,e[2]=-u*h,e[6]=b*c+w,e[10]=g-z*c}else if("XZY"===t.order){var g=s*a,b=s*u,w=o*a,z=o*u;e[0]=a*h,e[4]=-c,e[8]=u*h,e[1]=g*c+z,e[5]=s*h,e[9]=b*c-w,e[2]=w*c-b,e[6]=o*h,e[10]=z*c+g}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},u.prototype.makeRotationFromQuaternion=function(t){var e=this.elements,r=t.x,n=t.y,i=t.z,s=t.w,o=r+r,a=n+n,u=i+i,h=r*o,c=r*a,p=r*u,l=n*a,f=n*u,y=i*u,d=s*o,m=s*a,v=s*u;return e[0]=1-(l+y),e[4]=c-v,e[8]=p+m,e[1]=c+v,e[5]=1-(h+y),e[9]=f-d,e[2]=p-m,e[6]=f+d,e[10]=1-(h+l),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},u.prototype.lookAt=function(t,e,n){r();var a=i,u=s,h=o,c=this.elements;return h.subVectors(t,e).normalize(),0===h.lengthSq()&&(h.z=1),a.crossVectors(n,h).normalize(),0===a.lengthSq()&&(h.z+=1e-4,a.crossVectors(n,h).normalize()),u.crossVectors(h,a),c[0]=a.x,c[4]=u.x,c[8]=h.x,c[1]=a.y,c[5]=u.y,c[9]=h.y,c[2]=a.z,c[6]=u.z,c[10]=h.z,this},u.prototype.multiply=function(t){return this.multiplyMatrices(this,t)},u.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},u.prototype.multiplyMatrices=function(t,e){var r=t.elements,n=e.elements,i=this.elements,s=r[0],o=r[4],a=r[8],u=r[12],h=r[1],c=r[5],p=r[9],l=r[13],f=r[2],y=r[6],d=r[10],m=r[14],v=r[3],x=r[7],g=r[11],b=r[15],w=n[0],z=n[4],M=n[8],A=n[12],F=n[1],T=n[5],k=n[9],O=n[13],S=n[2],R=n[6],B=n[10],C=n[14],N=n[3],_=n[7],V=n[11],E=n[15];return i[0]=s*w+o*F+a*S+u*N,i[4]=s*z+o*T+a*R+u*_,i[8]=s*M+o*k+a*B+u*V,i[12]=s*A+o*O+a*C+u*E,i[1]=h*w+c*F+p*S+l*N,i[5]=h*z+c*T+p*R+l*_,i[9]=h*M+c*k+p*B+l*V,i[13]=h*A+c*O+p*C+l*E,i[2]=f*w+y*F+d*S+m*N,i[6]=f*z+y*T+d*R+m*_,i[10]=f*M+y*k+d*B+m*V,i[14]=f*A+y*O+d*C+m*E,i[3]=v*w+x*F+g*S+b*N,i[7]=v*z+x*T+g*R+b*_,i[11]=v*M+x*k+g*B+b*V,i[15]=v*A+x*O+g*C+b*E,this},u.prototype.multiplyToArray=function(t,e,r){var n=this.elements;return this.multiplyMatrices(t,e),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},u.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},u.prototype.applyToVector3Array=function(t,r,n){e();var s=i;void 0===r&&(r=0),void 0===n&&(n=t.length);for(var o=0,a=r;o<n;o+=3,a+=3)s.fromArray(t,a),s.applyMatrix4(this),s.toArray(t,a);return t},u.prototype.determinant=function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],s=t[1],o=t[5],a=t[9],u=t[13],h=t[2],c=t[6],p=t[10],l=t[14];return t[3]*(+i*a*c-n*u*c-i*o*p+r*u*p+n*o*l-r*a*l)+t[7]*(+e*a*l-e*u*p+i*s*p-n*s*l+n*u*h-i*a*h)+t[11]*(+e*u*c-e*o*l-i*s*c+r*s*l+i*o*h-r*u*h)+t[15]*(-n*o*h-e*a*c+e*o*p+n*s*c-r*s*p+r*a*h)},u.prototype.transpose=function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},u.prototype.setPosition=function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},u.prototype.getInverse=function(e,r){var n=this.elements,i=e.elements,s=i[0],o=i[1],a=i[2],u=i[3],h=i[4],c=i[5],p=i[6],l=i[7],f=i[8],y=i[9],d=i[10],m=i[11],v=i[12],x=i[13],g=i[14],b=i[15],w=y*g*l-x*d*l+x*p*m-c*g*m-y*p*b+c*d*b,z=v*d*l-f*g*l-v*p*m+h*g*m+f*p*b-h*d*b,M=f*x*l-v*y*l+v*c*m-h*x*m-f*c*b+h*y*b,A=v*y*p-f*x*p-v*c*d+h*x*d+f*c*g-h*y*g,F=s*w+o*z+a*M+u*A;if(0===F){var T="Matrix.getInverse(): can't invert matrix, determinant is 0";if(!0===r)throw new Error(T);return t.logger.warn(T),this.identity()}var k=1/F;return n[0]=w*k,n[1]=(x*d*u-y*g*u-x*a*m+o*g*m+y*a*b-o*d*b)*k,n[2]=(c*g*u-x*p*u+x*a*l-o*g*l-c*a*b+o*p*b)*k,n[3]=(y*p*u-c*d*u-y*a*l+o*d*l+c*a*m-o*p*m)*k,n[4]=z*k,n[5]=(f*g*u-v*d*u+v*a*m-s*g*m-f*a*b+s*d*b)*k,n[6]=(v*p*u-h*g*u-v*a*l+s*g*l+h*a*b-s*p*b)*k,n[7]=(h*d*u-f*p*u+f*a*l-s*d*l-h*a*m+s*p*m)*k,n[8]=M*k,n[9]=(v*y*u-f*x*u-v*o*m+s*x*m+f*o*b-s*y*b)*k,n[10]=(h*x*u-v*c*u+v*o*l-s*x*l-h*o*b+s*c*b)*k,n[11]=(f*c*u-h*y*u-f*o*l+s*y*l+h*o*m-s*c*m)*k,n[12]=A*k,n[13]=(f*x*a-v*y*a+v*o*d-s*x*d-f*o*g+s*y*g)*k,n[14]=(v*c*a-h*x*a-v*o*p+s*x*p+h*o*g-s*c*g)*k,n[15]=(h*y*a-f*c*a+f*o*p-s*y*p-h*o*d+s*c*d)*k,this},u.prototype.scale=function(t){var e=this.elements,r=t.x,n=t.y,i=t.z;return e[0]*=r,e[4]*=n,e[8]*=i,e[1]*=r,e[5]*=n,e[9]*=i,e[2]*=r,e[6]*=n,e[10]*=i,e[3]*=r,e[7]*=n,e[11]*=i,this},u.prototype.getMaxScaleOnAxis=function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,n))},u.prototype.makeTranslation=function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},u.prototype.makeRotationX=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this},u.prototype.makeRotationY=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this},u.prototype.makeRotationZ=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this},u.prototype.makeRotationAxis=function(t,e){var r=Math.cos(e),n=Math.sin(e),i=1-r,s=t.x,o=t.y,a=t.z,u=i*s,h=i*o;return this.set(u*s+r,u*o-n*a,u*a+n*o,0,u*o+n*a,h*o+r,h*a-n*s,0,u*a-n*o,h*a+n*s,i*a*a+r,0,0,0,0,1),this},u.prototype.makeScale=function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},u.prototype.makeShear=function(t,e,r){return this.set(1,e,r,0,t,1,r,0,t,e,1,0,0,0,0,1),this},u.prototype.compose=function(t,e,r){return this.makeRotationFromQuaternion(e),this.scale(r),this.setPosition(t),this},u.prototype.decompose=function(t,r,s){e(),n();var o=i,u=a,h=this.elements,c=o.set(h[0],h[1],h[2]).length(),p=o.set(h[4],h[5],h[6]).length(),l=o.set(h[8],h[9],h[10]).length();this.determinant()<0&&(c=-c),t.x=h[12],t.y=h[13],t.z=h[14],u.elements.set(this.elements);var f=1/c,y=1/p,d=1/l;return u.elements[0]*=f,u.elements[1]*=f,u.elements[2]*=f,u.elements[4]*=y,u.elements[5]*=y,u.elements[6]*=y,u.elements[8]*=d,u.elements[9]*=d,u.elements[10]*=d,r.setFromRotationMatrix(u),s.x=c,s.y=p,s.z=l,this},u.prototype.makeFrustum=function(t,e,r,n,i,s){var o=this.elements,a=2*i/(e-t),u=2*i/(n-r),h=(e+t)/(e-t),c=(n+r)/(n-r),p=-(s+i)/(s-i),l=-2*s*i/(s-i);return o[0]=a,o[4]=0,o[8]=h,o[12]=0,o[1]=0,o[5]=u,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=p,o[14]=l,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},u.prototype.makePerspective=function(t,e,r,n){var i=r*Math.tan(Math.PI/180*t*.5),s=-i,o=s*e,a=i*e;return this.makeFrustum(o,a,s,i,r,n)},u.prototype.makeOrthographic=function(t,e,r,n,i,s){var o=this.elements,a=1/(e-t),u=1/(r-n),h=1/(s-i),c=(e+t)*a,p=(r+n)*u,l=(s+i)*h;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-p,o[2]=0,o[6]=0,o[10]=-2*h,o[14]=-l,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},u.prototype.equals=function(t){for(var e=this.elements,r=t.elements,n=0;n<16;++n)if(e[n]!==r[n])return!1;return!0},u.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var r=0;r<16;++r)this.elements[r]=t[r+e];return this},u.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t},u}()}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(){return{center:t.createVector3(),radius:0}}function r(){void 0===i&&(i=t.createVector3())}function n(){void 0===s&&(s=[t.createVector3(),t.createVector3(),t.createVector3(),t.createVector3(),t.createVector3(),t.createVector3(),t.createVector3(),t.createVector3()])}t.createBox3=function(t,e){return new o(t,e)},t.isBox3Class=function(t){return t instanceof o};var i,s,o=function(){function o(e,r){this.min=void 0!==e?e:t.createVector3(1/0,1/0,1/0),this.max=void 0!==r?r:t.createVector3(-1/0,-1/0,-1/0)}return o.prototype.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},o.prototype.setFromArray=function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,s=-1/0,o=-1/0,a=0,u=t.length;a<u;a+=3){var h=t[a],c=t[a+1],p=t[a+2];h<e&&(e=h),c<r&&(r=c),p<n&&(n=p),h>i&&(i=h),c>s&&(s=c),p>o&&(o=p)}this.min.set(e,r,n),this.max.set(i,s,o)},o.prototype.setFromPoints=function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;++e)this.expandByPoint(t[e]);return this},o.prototype.setFromCenterAndSize=function(t,e){r();var n=i.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},o.prototype.clone=function(){return(new this.constructor).copy(this)},o.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},o.prototype.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},o.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},o.prototype.getCenter=function(e){var r=e||t.createVector3();return this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)},o.prototype.getSize=function(e){var r=e||t.createVector3();return this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)},o.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},o.prototype.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},o.prototype.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},o.prototype.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},o.prototype.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},o.prototype.getParameter=function(e,r){return(r||t.createVector3()).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},o.prototype.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},o.prototype.intersectsSphere=function(t){return r(),this.clampPoint(t.center,i),i.distanceToSquared(t.center)<=t.radius*t.radius},o.prototype.intersectsPlane=function(t){var e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=t.constant&&r>=t.constant},o.prototype.clampPoint=function(e,r){return(r||t.createVector3()).copy(e).clamp(this.min,this.max)},o.prototype.distanceToPoint=function(t){return r(),i.copy(t).clamp(this.min,this.max).sub(t).length()},o.prototype.getBoundingSphere=function(t){r();var n=t||e();return this.getCenter(n.center),n.radius=.5*this.getSize(i).length(),n},o.prototype.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},o.prototype.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},o.prototype.applyMatrix4=function(t){return n(),this.isEmpty()?this:(s[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),s[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),s[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),s[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),s[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),s[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),s[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),s[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(s),this)},o.prototype.translate=function(t){return this.min.add(t),this.max.add(t),this},o.prototype.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},o}()}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(t,e,r,n){t[e]=.5*(r[n]+r[n+3]),t[e+1]=.5*(r[n+1]+r[n+4]),t[e+2]=.5*(r[n+2]+r[n+5])}function r(t,e,r){t[0]>e[r]&&(t[0]=e[r]),t[3]<e[r]&&(t[3]=e[r]),t[1]>e[r+1]&&(t[1]=e[r+1]),t[4]<e[r+1]&&(t[4]=e[r+1]),t[2]>e[r+2]&&(t[2]=e[r+2]),t[5]<e[r+2]&&(t[5]=e[r+2])}function n(t,e,r){var n=void 0===r?0:r;t[0]>e[n]&&(t[0]=e[n]),t[1]>e[n+1]&&(t[1]=e[n+1]),t[2]>e[n+2]&&(t[2]=e[n+2]),t[3]<e[n+3]&&(t[3]=e[n+3]),t[4]<e[n+4]&&(t[4]=e[n+4]),t[5]<e[n+5]&&(t[5]=e[n+5])}function i(t,e,r,n){for(var i=0;i<3;++i)t[e+i]=r[n+3+i]-r[n+i]}function s(t,e){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]}function o(t){t[0]=1/0,t[1]=1/0,t[2]=1/0,t[3]=-1/0,t[4]=-1/0,t[5]=-1/0}function a(t,e){var r=void 0===e?0:e,n=t[r+3]-t[r],i=t[r+4]-t[r+1],s=t[r+5]-t[r+2];return n<0||i<0||s<0?0:2*(n*n+i*i+s*s)}function u(t,e,i,s,o,a,u){for(var h=t.centroids,c=t.indices4frags,p=t.boxes,l=u*(1-b)/a[s],f=o[s],y=t.sort4frags,d=e;d<=i;++d){var m=0|c[d],v=0|l*(h[m*z+s]-f);v<0?v=0:v>=u&&(v=u-1),y[d]=v,A[v].np++,n(A[v].bx,p,m*M),r(A[v].cd,h,m*z)}}function h(t,e,r,i,o,h,c){if(h[i]<t.epsilon)c.bct=1/0;else{var p=x;p>r-e+1&&(p=r-e+1);var l;for(l=0;l<p;++l)A[l].reset();for(l=0;l<p-1;++l)F[l].reset();c.bn=p,u(t,e,r,i,o,h,p),s(F[0].bl,A[0].bx),s(F[0].cl,A[0].cd),F[0].al=a(F[0].bl),F[0].nl=A[0].np;var f,y;for(l=1;l<p-1;++l)f=A[l],s((y=F[l]).bl,F[l-1].bl),n(y.bl,f.bx),y.al=a(y.bl),s(y.cl,F[l-1].cl),n(y.cl,f.bx),y.nl=F[l-1].nl+f.np;s(k,A[l=p-1].bx),s(O,A[l].cd);var d=a(k),m=A[l].np,v=l,g=d*m+F[l-1].al*F[l-1].nl;for(s(c.rvb,k),s(c.rcb,A[l].cd),s(c.lvb,F[l-1].bl),s(c.lcb,F[l-1].cl),c.ln=F[l-1].nl,l-=1;l>=1;--l){f=A[l],n(k,f.bx),n(O,f.cd);var b=(d=a(k))*(m+=f.np)+F[l-1].al*F[l-1].nl;b<=g&&(g=b,v=l,s(c.rvb,k),s(c.rcb,O),s(c.lvb,F[l-1].bl),s(c.lcb,F[l-1].cl),c.ln=F[l-1].nl)}c.bst=v,c.bct=g}}function c(t,e,r,n,i,s,o){var a,u,h=t.indices4frags,c=t.sort4frags,p=0,l=0|e,f=0|o.bst;for(a=e;a<=r;++a)u=0|h[a],c[a]<f?h[l++]=u:c[p++]=u;for(a=0;a<p;++a)h[l+a]=c[a]}function p(t,e,n,s,a,u,h,c){var p=t.indices4frags,l=t.centroids,f=a-s+1;f>t.frags4inner&&(f=t.frags4inner),f>c&&(f=c),e.setFragStart(n,s),e.setFragCount(n,f),s+=f,o(u);for(var y=s;y<=a;++y)r(u,l,z*p[y]);i(h,0,u,0);var d=0;return h[1]>h[0]&&(d=1),h[2]>h[d]&&(d=2),d}function l(t,e,r,n,s,o,a,u){i(S,0,o,0);var l=t.nodes,f=a?t.frags4tleaf:t.frags4leaf,y=a?t.frags4tinner:t.frags4tleaf,m=t.maxfrags4leaf,v=0;S[1]>S[0]&&(v=1),S[2]>S[v]&&(v=2),l.setBox(e,s);var x=0,b=0;if(t.length)for(var w=r;w<=n&&(x+=t.facets[t.indices4frags[w]],b++,!(x>m));++w);var z=n-r+1;if(z<=f&&z<m||1===z||u>g||S[v]<t.epsilon)return l.setLeftLeaf(e,-1),l.setFragStart(e,r),l.setFragCount(e,n-r+1),void l.setFlags(e,0,0,a);y&&(v=p(t,l,e,r,n,o,S,b),r+=l.getFragCount(e));var M=new d;if(h(t,r,n,v,o,S,M),M.bn<0)l.setFragCount(e,l.getFragCount(e)+n-r+1);else{c(t,r,n,v,o,S,M);var A=l.nextNodes(2),F=.5*(M.lvb[3+v]+M.lvb[v]),T=.5*(M.rvb[3+v]+M.rvb[v]);l.setFlags(e,v,F<T?0:1,a),l.setLeftLeaf(e,A),t.rstack.push([t,A+1,r+M.ln,n,M.rvb,M.rcb,a,u+1]),t.rstack.push([t,A,r,r+M.ln-1,M.lvb,M.lcb,a,u+1])}}function f(t){var s=t.bvo,a=t.bco,u=t.bvt,h=t.bct;o(s),o(a),o(u),o(h);for(var c=t.centroids,p=t.boxes,l=0,f=t.length;l<f;++l)e(c,z*l,p,M*l),l>=t.transparent1st?(r(h,c,z*l),n(u,p,M*l)):(r(a,c,z*l),n(s,p,M*l));i(S,0,t.bvo,0);var y=Math.max(S[0],S[1],S[2]);t.epsilon=w*y}var y=function(){function t(t){this.bytes4node=36;var e,r;t instanceof ArrayBuffer?(e=t.byteLength/this.bytes4node,r=t,this.length=e):(e=0|t,r=new ArrayBuffer(this.bytes4node*e),this.length=0),this.capacity=e,this.raw=r,this.stride=this.bytes4node/4,this.sstride=this.bytes4node/2,this.Fn=new Float32Array(r),this.In=new Int32Array(r),this.Sn=new Uint16Array(r)}return t.prototype.setLeftLeaf=function(t,e){this.In[t*this.stride+6]=e},t.prototype.getLeftLeaf=function(t){return this.In[t*this.stride+6]},t.prototype.setFragStart=function(t,e){this.In[t*this.stride+8]=e},t.prototype.getFragStart=function(t){return this.In[t*this.stride+8]},t.prototype.setFragCount=function(t,e){this.Sn[t*this.sstride+14]=e},t.prototype.getFragCount=function(t){return this.Sn[t*this.sstride+14]},t.prototype.setFlags=function(t,e,r,n){this.Sn[t*this.sstride+15]=n<<3|r<<2|3&e},t.prototype.getFlags=function(t){return this.Sn[t*this.sstride+15]},t.prototype.setBox=function(t,e){var r=t*this.stride,n=this.Fn;e instanceof Float32Array?(n[r]=e[0],n[r+1]=e[1],n[r+2]=e[2],n[r+3]=e[3],n[r+4]=e[4],n[r+5]=e[5]):(n[r]=e.min.x,n[r+1]=e.min.y,n[r+2]=e.min.z,n[r+3]=e.max.x,n[r+4]=e.max.y,n[r+5]=e.max.z)},t.prototype.getBox=function(t,e){var r=t*this.stride,n=this.Fn;e.min.x=n[r],e.min.y=n[r+1],e.min.z=n[r+2],e.max.x=n[r+3],e.max.y=n[r+4],e.max.z=n[r+5]},t.prototype.makeEmpty=function(t){var e=t*this.stride,r=this.In;r[e+6]=-1,r[e+7]=0,r[e+8]=-1},t.prototype.realloc=function(t){if(this.length+t>this.capacity){var e=0|3*this.capacity/2;e<this.length+t&&(e=this.length+t);var r=new ArrayBuffer(e*this.bytes4node),n=new Int32Array(r);n.set(this.In),this.capacity=e,this.raw=r,this.Fn=new Float32Array(r),this.In=n,this.Sn=new Uint16Array(r)}},t.prototype.nextNodes=function(t){this.realloc(t);var e=this.length;this.length+=t;for(var r=0;r<t;++r)this.makeEmpty(e+r);return e},t.prototype.getRaw=function(){return this.raw.slice(0,this.length*this.bytes4node)},t}(),d=function(){function t(){this.lvb=new Float32Array(6),this.rvb=new Float32Array(6),this.lcb=new Float32Array(6),this.rcb=new Float32Array(6),this.ln=0,this.bn=-1,this.bst=-1,this.bct=-1}return t.prototype.reset=function(){this.ln=0,this.bn=-1,this.bst=-1,this.bct=-1},t}(),m=function(){function t(){this.bx=new Float32Array(6),this.cd=new Float32Array(6),this.np=0}return t.prototype.reset=function(){this.np=0,o(this.bx),o(this.cd)},t}(),v=function(){function t(){this.bl=new Float32Array(6),this.cl=new Float32Array(6),this.nl=0,this.al=0}return t.prototype.reset=function(){this.nl=0,this.al=0,o(this.bl),o(this.cl)},t}(),x=16,g=15,b=1e-5,w=1e-5,z=3,M=6,A=[],F=[],T=void 0;for(T=0;T<x;++T)A.push(new m);for(T=0;T<x-1;++T)F.push(new v);var k=new Float32Array(6),O=new Float32Array(6),S=new Float32Array(3),R=function(){function e(t,e){this.boxes=t.bbox,this.facets=t.facets,this.materialIds=t.materialIdx,this.materials=e,this.length=t.length,this.frags4leaf=-1,this.frags4inner=-1,this.nodes=null,this.buffer=new ArrayBuffer(4*this.length),this.sort4frags=new Int32Array(this.buffer),this.indices4frags=new Int32Array(this.length),this.centroids=new Float32Array(z*this.length),this.bvo=new Float32Array(6),this.bco=new Float32Array(6),this.bvt=new Float32Array(6),this.bct=new Float32Array(6),this.rstack=[]}return e.prototype.sort=function(){for(var t=new Float32Array(this.buffer),e=this.materialIds,r=this.materials,n=this.indices4frags,i=0,s=0,o=this.length;s<o;++s){n[s]=s;var a=!(!r||!r[e[s]])&&r[e[s]].transparency;a&&i++,t[s]=a?-1:1}if(i&&i<this.length){for(var u=new Int32Array(i),h=0,c=0,s=0,o=this.length;s<o;++s)t[s]>=0?n[h++]=n[s]:u[c++]=n[s];n.set(u,this.length-i)}this.transparent1st=this.length-i},e.prototype.build=function(){var e=t.isMobile()?.5:1;if(this.frags4leaf=0|32*e,this.frags4inner=0|this.frags4leaf,this.frags4tleaf=this.frags4leaf,this.frags4tinner=0,this.maxfrags4leaf=0|1e4*e,this.nodes)this.nodes.length=0;else{for(var r=this.length/this.frags4leaf,n=1;n<r;)n*=2;this.nodes=new y(n)}this.sort(),f(this);var i=this.nodes.nextNodes(2);l(this,i,0,this.transparent1st-1,this.bvo,this.bco,0,0);for(var s;this.rstack.length;)l((s=this.rstack.pop())[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]);for(l(this,i+1,this.transparent1st,this.length-1,this.bvt,this.bct,1,0);this.rstack.length;)l((s=this.rstack.pop())[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7])},e}();t.createBVH=function(t,e){return new R(t,e)}}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(t){for(var e=new Uint16Array(t.length),r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e.buffer}var r=function(){function r(){}return r.prototype.arrayBuffer=function(){return this._body instanceof ArrayBuffer?this._body:e(this.text())},r.prototype.blob=function(){if(this._body instanceof Blob)return this._body;if(this._body instanceof ArrayBuffer)return new Blob([this._body]);throw new Error("The request body isn't either a blob or an array buffer")},r.prototype.json=function(){return"string"==typeof this._body?JSON.parse(this._body):this._body instanceof ArrayBuffer?JSON.parse(this.text()):this._body},r.prototype.text=function(){return this._body instanceof t.URLSearchParams?this._body.toString():this._body instanceof ArrayBuffer?String.fromCharCode.apply(null,new Uint16Array(this._body)):null===this._body?"":"object"==typeof this._body?JSON.stringify(this._body,null,2):this._body.toString()},r}();t.Body=r}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}var n=Object.prototype.hasOwnProperty,i=function(){function i(e){if(this._headers=t.createDictionary(),e instanceof i)for(var r in e._headers)for(var s=e._headers[r],o=0;o<s.length;++o)this.append(r,s[o]);else for(var r in e)if(n.call(e,r)){s=Array.isArray(e[r])?e[r]:[e[r]];this.delete(r);for(o=0;o<s.length;++o)this.append(r,s[o])}}return i.prototype.append=function(t,e){var r=this.getAll(t);null===r?this.set(t,e):r.push(e)},i.prototype.delete=function(t){delete this._headers[e(t)]},i.prototype.get=function(t){var e=this.getAll(t);return null===e?null:e.length>0?e[0]:null},i.prototype.getAll=function(t){return this.has(t)?this._headers[e(t)]:null},i.prototype.has=function(t){return e(t)in this._headers},i.prototype.keys=function(){var t=[];for(var e in this._headers)t.push(e);return t},i.prototype.set=function(t,n){if(Array.isArray(n)){if(n.length){for(var i=[],s=0;s<n.length;++s)i.push(r(n[s]));this._headers[e(t)]=i}}else this._headers[e(t)]=[r(n)]},i.prototype.values=function(){var t=[];for(var e in this._headers)t.push(this._headers[e]);return t},i.prototype.toJSON=function(){var t={};for(var e in this._headers){for(var r=[],n=this._headers[e],i=0;i<n.length;++i)r.push(n[i]);t[e]=r}return t},i.fromResponseHeaderString=function(t){for(var e=new i,r=t.split("\n"),n=0;n<r.length;++n){var s=r[n],o=s.indexOf(":");if(o>0){var a=s.slice(0,o),u=s.slice(o+1).trim();e.set(a,u)}}return e},i}();t.Headers=i}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(t){if("string"!=typeof t)return t;switch(t.toUpperCase()){case"GET":return r.Get;case"POST":return r.Post;case"PUT":return r.Put;case"DELETE":return r.Delete;case"OPTIONS":return r.Options;case"HEAD":return r.Head;case"PATCH":return r.Patch}throw new Error('Invalid request method. The method "'+t+'" is not supported.')}var r,n=function(){};!function(t){t[t.Get=0]="Get",t[t.Post=1]="Post",t[t.Put=2]="Put",t[t.Delete=3]="Delete",t[t.Options=4]="Options",t[t.Head=5]="Head",t[t.Patch=6]="Patch"}(r=t.RequestMethod||(t.RequestMethod={}));var i;!function(t){t[t.NONE=0]="NONE",t[t.JSON=1]="JSON",t[t.FORM=2]="FORM",t[t.FORM_DATA=3]="FORM_DATA",t[t.TEXT=4]="TEXT",t[t.BLOB=5]="BLOB",t[t.ARRAY_BUFFER=6]="ARRAY_BUFFER"}(i=t.ContentType||(t.ContentType={}));!function(t){t[t.Text=0]="Text",t[t.Json=1]="Json",t[t.ArrayBuffer=2]="ArrayBuffer",t[t.Blob=3]="Blob"}(t.ResponseContentType||(t.ResponseContentType={}));var s=function(){function r(r){var n=void 0===r?{}:r,i=n.method,s=n.headers,o=n.body,a=n.url,u=n.search,h=n.withCredentials,c=n.responseType;this.method=null!=i?e(i):null,this.headers=null!=s?s:null,this.body=null!=o?o:null,this.url=null!=a?a:null,this.search=null!=u?"string"==typeof u?new t.URLSearchParams(u):u:null,this.withCredentials=null!=h?h:null,this.responseType=null!=c?c:null}return r.prototype.merge=function(e){return new r({method:e&&null!=e.method?e.method:this.method,headers:e&&null!=e.headers?e.headers:this.headers,body:e&&null!=e.body?e.body:this.body,url:e&&null!=e.url?e.url:this.url,search:e&&null!=e.search?"string"==typeof e.search?new t.URLSearchParams(e.search):e.search.clone():this.search,withCredentials:e&&null!=e.withCredentials?e.withCredentials:this.withCredentials,responseType:e&&null!=e.responseType?e.responseType:this.responseType})},r}();t.RequestOptions=s;var o=function(e){function n(){return e.call(this,{method:r.Get,headers:new t.Headers})||this}return __extends(n,e),n}(s);t.BaseRequestOptions=o;var a=function(r){function s(n){var i=r.call(this)||this,s=n.url;if(i.url=n.url,n.search){var o=n.search.toString();if(o.length>0){var a="?";-1!=i.url.indexOf("?")&&(a="&"==i.url[i.url.length-1]?"":"&"),i.url=s+a+o}}return i._body=n.body,i.method=e(n.method),i.headers=new t.Headers(n.headers),i.contentType=i.detectContentType(),i.withCredentials=n.withCredentials,i.responseType=n.responseType,i}return __extends(s,r),s.prototype.detectContentType=function(){switch(this.headers.get("content-type")){case"application/json":return i.JSON;case"application/x-www-form-urlencoded":return i.FORM;case"multipart/form-data":return i.FORM_DATA;case"text/plain":case"text/html":return i.TEXT;case"application/octet-stream":return i.BLOB;default:return this.detectContentTypeFromBody()}},s.prototype.detectContentTypeFromBody=function(){return null==this._body?i.NONE:this._body instanceof t.URLSearchParams?i.FORM:this._body instanceof n?i.FORM_DATA:this._body instanceof Blob?i.BLOB:this._body instanceof ArrayBuffer?i.ARRAY_BUFFER:this._body&&"object"==typeof this._body?i.JSON:i.TEXT},s.prototype.getBody=function(){switch(this.contentType){case i.JSON:return this.json();case i.FORM:return this.text();case i.FORM_DATA:return this._body;case i.TEXT:return this.text();case i.BLOB:return this.blob();case i.ARRAY_BUFFER:return this.arrayBuffer();default:return null}},s}(t.Body);t.Request=a}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";!function(t){t[t.Basic=0]="Basic",t[t.Cors=1]="Cors",t[t.Default=2]="Default",t[t.Error=3]="Error",t[t.Opaque=4]="Opaque"}(t.ResponseType||(t.ResponseType={}));var e=function(){return function(t){var e=void 0===t?{}:t,r=e.body,n=e.status,i=e.headers,s=e.statusText,o=e.type,a=e.url;this.body=null!=r?r:null,this.status=null!=n?n:null,this.headers=null!=i?i:null,this.statusText=null!=s?s:null,this.type=null!=o?o:null,this.url=null!=a?a:null}}();t.ResponseOptions=e;var r=function(t){function e(e){var r=t.call(this)||this;return r._body=e.body,r.status=e.status,r.ok=r.status>=200&&r.status<=299,r.statusText=e.statusText,r.headers=e.headers,r.type=e.type,r.url=e.url,r}return __extends(e,t),e}(t.Body);t.Response=r}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(e){void 0===e&&(e="");var r=t.createDictionary();if(e.length>0)for(var n=e.split("&"),i=0;i<n.length;++i){var s=n[i],o=n.indexOf("="),a=-1==o?[s,""]:[s.slice(0,o),s.slice(o+1)],u=a[0],h=a[1],c=r[u]||[];c.push(h),r[u]=c}return r}function r(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var n=function(){function t(){}return t.prototype.encodeKey=function(t){return r(t)},t.prototype.encodeValue=function(t){return r(t)},t}();t.QueryEncoder=n;var i=function(){function t(t,r){void 0===t&&(t=""),void 0===r&&(r=new n),this.rawParams=t,this.queryEncoder=r,this.params=e(t)}return t.prototype.clone=function(){var e=new t("",this.queryEncoder);return e.appendAll(this),e},t.prototype.has=function(t){return t in this.params},t.prototype.get=function(t){var e=this.params[t];return Array.isArray(e)?e[0]:null},t.prototype.getAll=function(t){return this.params[t]||[]},t.prototype.set=function(t,e){if(void 0!==e&&null!==e){var r=this.params[t]||[];r.length=0,r.push(e),this.params[t]=r}else this.delete(t)},t.prototype.setAll=function(t){for(var e in t.params){var r=this.params[e]||[];r.length=0,r.push(t.params[e][0]),this.params[e]=r}},t.prototype.append=function(t,e){if(void 0!==e&&null!==e){var r=this.params[t]||[];r.push(e),this.params[t]=r}},t.prototype.appendAll=function(t){for(var e in t.params){for(var r=this.params[e]||[],n=t.params[e],i=0;i<n.length;++i)r.push(n[i]);this.params[e]=r}},t.prototype.delete=function(t){delete this.params[t]},t.prototype.replaceAll=function(t){for(var e in t.params){var r=this.params[e]||[],n=t.params[e];r.length=0;for(var i=0;i<n.length;++i)r.push(n[i]);this.params[e]=r}},t.prototype.toString=function(){var t=[];for(var e in this.params)for(var r=this.params[e],n=0;n<r.length;++n)t.push(this.queryEncoder.encodeKey(e)+"="+this.queryEncoder.encodeValue(r[n]));return t.join("&")},t}();t.URLSearchParams=i}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(t){return"responseURL"in t?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):void 0}function r(e,r){if(null==e.headers||null==e.headers.get("Content-Type"))switch(e.contentType){case t.ContentType.NONE:break;case t.ContentType.JSON:r.setRequestHeader("content-type","application/json");break;case t.ContentType.FORM:r.setRequestHeader("content-type","application/x-www-form-urlencoded;charset=UTF-8");break;case t.ContentType.TEXT:r.setRequestHeader("content-type","text/plain");break;case t.ContentType.BLOB:var n=e.blob();n.type&&r.setRequestHeader("content-type",n.type)}}function n(n){return new Promise(function(i,o){var a=new XMLHttpRequest;a.open(t.RequestMethod[n.method].toUpperCase(),n.url),null!=n.withCredentials&&(a.withCredentials=n.withCredentials);var u=function(){var r=1223===a.status?204:a.status,u=null;204!==r&&"string"==typeof(u=null==a.response?a.responseText:a.response)&&(u=u.replace(s,"")),0===r&&(r=u?200:0);var h=t.Headers.fromResponseHeaderString(a.getAllResponseHeaders()),c=e(a)||n.url,p=a.statusText||"OK",l=new t.ResponseOptions({body:u,status:r,headers:h,statusText:p,url:c}),f=new t.Response(l);f.ok=r>=200&&r<300,f.ok?i(f):o(f)},h=function(e){var r=new t.ResponseOptions({body:e,type:t.ResponseType.Error,status:a.status,statusText:a.statusText});o(new t.Response(r))};if(r(n,a),null!=n.headers)for(var c in n.headers._headers)a.setRequestHeader(c,n.headers._headers[c].join(","));if(null!=n.responseType&&null!=a.responseType)switch(n.responseType){case t.ResponseContentType.ArrayBuffer:a.responseType="arraybuffer";break;case t.ResponseContentType.Json:a.responseType="json";break;case t.ResponseContentType.Text:a.responseType="text";break;case t.ResponseContentType.Blob:a.responseType="blob";break;default:throw new Error("The selected responseType is not supported")}return a.addEventListener("load",u),a.addEventListener("error",h),a.send(n.getBody()),function(){a.removeEventListener("load",u),a.removeEventListener("error",h),a.abort()}})}function i(e,r,n,i){var s=e;return r?s.merge(new t.RequestOptions({method:r.method||n,url:r.url||i,search:r.search,headers:r.headers,body:r.body,withCredentials:r.withCredentials,responseType:r.responseType})):s.merge(new t.RequestOptions({method:n,url:i}))}var s=/^\)\]\}',?\n/,o=function(){function e(t){this._defaultOptions=t}return e.prototype.request=function(e,r){if("string"==typeof e)return n(new t.Request(i(this._defaultOptions,r,t.RequestMethod.Get,e)));if(e instanceof t.Request)return n(e);throw new Error("url must be a string or Request Instance")},e.prototype.get=function(e,r){return this.request(new t.Request(i(this._defaultOptions,r,t.RequestMethod.Get,e)))},e.prototype.post=function(e,r,n){return this.request(new t.Request(i(this._defaultOptions.merge(new t.RequestOptions({body:r})),n,t.RequestMethod.Post,e)))},e.prototype.put=function(e,r,n){return this.request(new t.Request(i(this._defaultOptions.merge(new t.RequestOptions({body:r})),n,t.RequestMethod.Put,e)))},e.prototype.delete=function(e,r){return this.request(new t.Request(i(this._defaultOptions,r,t.RequestMethod.Delete,e)))},e.prototype.patch=function(e,r,n){return this.request(new t.Request(i(this._defaultOptions.merge(new t.RequestOptions({body:r})),n,t.RequestMethod.Patch,e)))},e.prototype.head=function(e,r){return this.request(new t.Request(i(this._defaultOptions,r,t.RequestMethod.Head,e)))},e.prototype.options=function(e,r){return this.request(new t.Request(i(this._defaultOptions,r,t.RequestMethod.Options,e)))},e}();t.Http=o}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(t){if(t.baseUrl="",t.url){var e=t.url.lastIndexOf("/");-1!==e&&(t.baseUrl=t.url.substr(0,e+1))}}t.route=function(r){switch(e(r),r.action){case 1:t.load(r);break;case 2:t.upload(r);break;case 3:t.search(r)}},self.raiseError=function(t,e,r){postMessage({error:{code:t,message:e,args:r}})},t.sendMessage=function(t,e){postMessage(t,e)}}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";var e=new ArrayBuffer(8),r=new Uint8Array(e),n=new Uint16Array(e),i=new Int32Array(e),s=new Uint32Array(e),o=new Float32Array(e),a=new Float64Array(e),u=String.fromCharCode,h=function(){function t(t){this.position=0,this.byteLength=t.byteLength,this.buffer=t}return t.prototype.getPosition=function(){return this.position},t.prototype.getByteLength=function(){return this.byteLength},t.prototype.seek=function(t,e){0===e?this.position=t:1===e?this.position+=t:2===e&&(this.position=this.byteLength-t)},t.prototype.reset=function(t){this.position=0,this.byteLength=t.byteLength,this.buffer=t},t.prototype.readDate=function(){var t=this.buffer[this.position],e=this.buffer[this.position+1],r=this.buffer[this.position+2],n=this.buffer[this.position+3];return this.position+=4,new Date(1980+(n>>1),15&(n<<3|r>>5),31&r,e>>3,63&(e<<3|t>>5),2*(31&t))},t.prototype.readBoolean=function(){return!!this.readUint8()},t.prototype.readUint8=function(){return this.buffer[this.position++]},t.prototype.readInt16=function(){var t=this.readUint16();return t>32767&&(t|=4294901760),t},t.prototype.readUint16=function(){return r[0]=this.buffer[this.position++],r[1]=this.buffer[this.position++],n[0]},t.prototype.readInt32=function(){return r[0]=this.buffer[this.position],r[1]=this.buffer[this.position+1],r[2]=this.buffer[this.position+2],r[3]=this.buffer[this.position+3],this.position+=4,i[0]},t.prototype.readUint32=function(){return r[0]=this.buffer[this.position],r[1]=this.buffer[this.position+1],r[2]=this.buffer[this.position+2],r[3]=this.buffer[this.position+3],this.position+=4,s[0]},t.prototype.readFloat32=function(){return r[0]=this.buffer[this.position],r[1]=this.buffer[this.position+1],r[2]=this.buffer[this.position+2],r[3]=this.buffer[this.position+3],this.position+=4,o[0]},t.prototype.readFloat64=function(){for(var t=0;t<8;t++)r[t]=this.buffer[this.position+t];return this.position+=8,a[0]},t}();h.prototype.readString=function(){var t,e,r,n,i,s,o="";return function(){for(t=0,o="",s=this.readVarint(),i=this.position;t<s;)switch((e=this.buffer[i+t++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=u(e);break;case 12:case 13:r=this.buffer[i+t++],o+=u((31&e)<<6|63&r);break;case 14:r=this.buffer[i+t++],n=this.buffer[i+t++],o+=u((15&e)<<12|(63&r)<<6|(63&n)<<0)}return this.position+=s,o}}(),h.prototype.readVarint=function(){var t,e=0,r=0;return function(){e=0,r=0;do{t=this.readUint8(),e|=(127&t)<<r,r+=7}while(128&t);return e}}();var c=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.readStrideArray=function(t,e,r,n,i,s){var o=this.buffer,a=this.position,u=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);r*=s,i*=s,n*=4;for(var h=0;h<e;++h){for(var c=0;c<i;++c)u[r+c]=o[a++];r+=n}this.position=a},e.prototype.readArray=function(t,e){var r=e*t.BYTES_PER_ELEMENT;new Uint8Array(t.buffer,t.byteOffset,t.byteLength).set(this.buffer.subarray(this.position,this.position+r)),this.position+=r},e}(h);c.prototype.readVector3f=function(){var e=t.createVector3();return function(){return e.x=this.readFloat32(),e.y=this.readFloat32(),e.z=this.readFloat32(),e.clone()}}(),c.prototype.readVector3d=function(){var t={x:0,y:0,z:0};return function(){return t.x=this.readFloat64(),t.y=this.readFloat64(),t.z=this.readFloat64(),t}}(),c.prototype.readTransform4=function(){var e={x:1,y:1,z:1},r=t.createMatrix4(!0);return function(){var t,n;switch(this.readUint8()){case 0:r.identity();break;case 1:t=this.readVector3d(),r.makeTranslation(t.x,t.y,t.z);break;case 2:n=this.readQuaternionf(),t=this.readVector3d(),e.x=1,e.y=1,e.z=1,r.compose(t,n,e);break;case 3:var i=this.readFloat32();n=this.readQuaternionf(),t=this.readVector3d(),e.x=i,e.y=i,e.z=i,r.compose(t,n,e);break;case 4:this.readMatrix3f(r),t=this.readVector3d(),r.setPosition(t);break;default:return null}return r}}(),c.prototype.readMatrix3f=function(){var e=t.createMatrix4();return function(t){t||(t=e),t.identity();var r=this.readVector3f(),n=this.readVector3f(),i=this.readVector3f();return t.makeBasis(r,n,i),t}}(),c.prototype.readQuaternionf=function(){var t={x:0,y:0,z:0,w:0};return function(){return t.x=this.readFloat32(),t.y=this.readFloat32(),t.z=this.readFloat32(),t.w=this.readFloat32(),t}}(),c.prototype.readBox=function(){var e=t.createBox3();return function(){return e.min.x=this.readFloat32(),e.min.y=this.readFloat32(),e.min.z=this.readFloat32(),e.max.x=this.readFloat32(),e.max.y=this.readFloat32(),e.max.z=this.readFloat32(),e.clone()}}(),c.prototype.readUniqueId=function(){var t,e=function(t){var e=t>>4&15,r=15&t;return u(e>9?e-10+97:e+48)+u(r>9?r-10+97:r+48)},r="";return function(){r="",t=this.readInt32(),r+=e(t>>24),r+=e(t>>16),r+=e(t>>8),r+=e(t),r+="-",t=this.readInt16(),r+=e(t>>8),r+=e(t),r+="-",t=this.readInt16(),r+=e(t>>8),r+=e(t),r+="-",t=this.readUint8(),r+=e(t),t=this.readUint8(),r+=e(t),r+="-";for(var n=0;n<6;n++)t=this.readUint8(),r+=e(t);return r}}(),t.createStream=function(t){return new c(t)}}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";t.createContext=function(t){return new e(t)};var e=function(){function e(t){this.reset(t)}return e.prototype.reset=function(e){this.stream?this.stream.reset(e):this.stream=t.createStream(e),this.objectTypes=[],this.objectOffsets=[];var r=this.stream;if(1515259669!==r.readUint32())return null;this.version=r.readUint16(),this.compress=r.readUint16(),this.time=r.readDate(),r.seek(8,2);var n=r.readUint32(),i=r.readUint32();r.seek(i,0);for(var s=r.readVarint(),o=0;o<s;++o)this.objectTypes.push({version:r.readVarint(),type:r.readVarint(),description:r.readString()});r.seek(n,0);for(var a=r.readVarint(),o=0;o<a;++o)this.objectOffsets.push(r.readUint32());r.seek(0,0),this.stream=r},e.prototype.getObject=function(t){if(t>=this.objectOffsets.length)return null;this.stream.seek(this.objectOffsets[t],0);var e=this.stream.readVarint();return e>=this.objectTypes.length?null:this.objectTypes[e]},e.prototype.getObjectCount=function(){return this.objectOffsets.length},e}()}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(e){void 0===e.taskType&&(e.taskType=e.packageType),s(e);var r=new t.BaseRequestOptions,n=e.options||{};r=r.merge(n),new t.Http(r).get(e.url).then(function(r){if(e.context?e.context.reset(t.unzip(new Uint8Array(r.arrayBuffer()))):e.context=t.createContext(t.unzip(new Uint8Array(r.arrayBuffer()))),e.packageType)return a(e,function(){u(e)});throw new Error("Unknown Data")},function(t){o(t.status,t.statusText,t.url)}).catch(function(t){e.worker.raiseError(2,t.toString(),{url:e.url})})}function r(r){if((x|=r.packageType)!==g)1&x?4&x?8&x?2&x?64&x||(r.packageType=-2147483584):r.packageType=-2147483646:r.packageType=-2147483640:r.packageType=-2147483644:r.packageType=-2147483647,e(r);else{var i=r.data.transferList;delete r.data.transferList,r.data.packageType=r.taskType,n(r.data,i),t.sendMessage(r.data,i),r=null,i=null}}function n(e,r){var n,i,s=e.meshes,o=e.fragments.facets,a=e.fragments.mesh2frag,u=t.createDictionary();e.fragments.loaded=0;for(var h=0;h<s.length;++h){if(n=a[h],i=s[h],t.isArray(n))for(var c=0;c<n.length;++c)o[n[c]]=i.facetCount;else o[n]=i.facetCount;u[parseInt(i.package)+":"+i.idx]=h}e.geometries=u,e.boundingBox=e.world.boundingBox,e.worldMatrix=e.world.transform,e.up=e.world.up,delete e.meshes,delete e.world;var p=t.createBVH(e.fragments,e.materials);p.build(),e.nodes=p.nodes,e.indices=p.indices4frags,r.push(p.nodes.getRaw()),r.push(p.indices4frags.buffer)}function i(t){switch(t){case 1:return"project.jdx";case 8:return"fragment.jdx";case 4:return"texc.jdx";case 2:return"geometry.jdx";case 64:return"props.adx";default:return""}}function s(e){2147483648&e.packageType&&(e.data||(e.data={},e.data.transferList=[]),e.packageType&=2147483647,0===e.packageType&&(e.packageType=1),e.options.responseType=t.ResponseContentType.ArrayBuffer,e.url=e.baseUrl+i(e.packageType))}function o(t,e,r){403==t?self.raiseError(4,"\u8bbf\u95ee\u88ab\u62d2\u7edd\u7684\u7f51\u7edc\u8d44\u6e90(HTTP 403)",{url:r.url,status:t,statusText:e}):404==t?self.raiseError(5,"\u627e\u4e0d\u5230\u7f51\u7edc\u8d44\u6e90 (HTTP 404)",{url:r.url,status:t,statusText:e}):t>=500&&t<600?self.raiseError(6,"\u8bbf\u95ee\u7f51\u7edc\u8d44\u6e90\u65f6\uff0c\u670d\u52a1\u5668\u9519\u8bef (HTTP 5xx)",{url:r.url,status:t,statusText:e}):r.exception?self.raiseError(3,"\u7f51\u7edc\u9519\u8bef",{url:r.url,exception:r.exception.toString(),stack:r.exception.stack}):self.raiseError(7,"\u8bbf\u95ee\u7f51\u7edc\u8d44\u6e90\u65f6\u8fd4\u56de\u672a\u94bc\u662f\u7684\u54cd\u5e94\u4ee3\u7801 (HTTP 'everything else')",{url:r.url,status:t,statusText:e,data:r})}function a(t,e){try{e()}catch(e){t.worker.raiseError(2,"",{url:t.url,exception:e.toString(),stack:e.stack})}}function u(t){switch(t.packageType){case 32:l(t);break;case 2:f(t);break;case 8:y(t);break;case 1:d(t);break;case 4:m(t);break;case 64:v(t)}}function h(t,e,r,n){return{objectDef:r,package:t,workerId:-1,packageType:e,vb:n=n||null,vbo:[]}}function c(){return{world:{up:null,boundingBox:null,transform:null},camera:{isPerspective:!1,aspect:0,fov:50,orthoScale:0,position:null,target:null,up:null},packages:[],uuids:[]}}function p(e,r,n){var i=e[r];void 0===i?e[r]=n:t.isArray(i)?i.push(n):(e[r]=[i],e[r].push(n))}function l(e){function r(t){var e=a.getObject(t);if(!e)return 0;var r=a.stream;if(2===e.type){if(1510801694!==r.readUint32())return 0;var n=r.readUint32(),i=r.readUint32();return 4*(n*(6+2*r.readUint32()+0*r.readUint32())+((3*i*2+3)/4|0))}return e.type,0}function n(t,e,r){var n=t.vertexCount,i=t.facetCount,s=t.strides,o=n*s,a=o+((3*i*2+3)/4|0);t.byteLength=4*a,t.vb=new Float32Array(e,r,o),t.indices=new Uint16Array(e,r+4*o,3*i),u.readArray(t.indices,3*i),u.readStrideArray(t.vb,n,t.attributes.position.offset,s,t.attributes.position.itemSize,4),u.readStrideArray(t.vb,n,t.attributes.normal.offset,s,t.attributes.normal.itemSize,4),u.readStrideArray(t.vb,n,t.attributes.uv.offset,s,t.attributes.uv.itemSize,4)}function i(t,e){if(1510801694!==u.readUint32())return null;var r={};return r.vertexCount=u.readUint32(),r.facetCount=u.readUint32(),r.uvMapCount=u.readUint32(),r.attrsCount=u.readUint32(),r.strides=8,r.attributes={},r.attributes.position={offset:0,itemSize:3},r.attributes.normal={offset:3,itemSize:3},r.attributes.uv={offset:6,itemSize:2},n(r,t,e),r}function s(t,e,r){var n=a.getObject(t);return n?2===n.type?i(e,r):4===n.type?null:(n.type,null):null}var o=e.worker,a=e.context,u=a.stream;return function(){for(var n=a.getObjectCount(),i=!1,u=0,c=0;c<n;++c)u+=r(c);var p=u?new ArrayBuffer(u):null,l=0,f=p?[p]:[],y=h(e.package,e.packageType,2,p);y.workerId=e.workerId;for(c=0;c<n;++c){var d=s(c,p,l);d?(l+=d.byteLength||0,y.vbo[c]=d):(i||(o.raiseError(2,"Bad Data",{url:e.url}),i=!0),t.sendMessage(e,y))}t.sendMessage(y,f)}()}function f(e){function n(){var t={facetCount:a.readUint32(),package:a.readString(),idx:a.readVarint()};return a.readBox(),t}function i(t){var e=o.getObject(t);return e&&6===e.type?n():null}var s=e.worker,o=e.context,a=o.stream;return function(){for(var n=!1,a=o.getObjectCount(),u=h(e.package,e.packageType,6),c=0;c<a;++c){var p=i(c);p?u.vbo[c]=p:(n||(s.raiseError(2,"Bad Data",{url:e.url}),n=!0),t.sendMessage(e,u))}e.data?(e.data.meshes=u.vbo,r(e)):t.sendMessage(u),u=null}()}function y(e){function n(t,r){r.materialIdx[t]=a.readVarint();var n=a.readVarint();p(r.mesh2frag,n,t),r.frag2mesh[t]=n;for(var i=6*t,s=0;s<6;++s)r.bbox[i+s]=a.readFloat32();var o=a.readTransform4();if(e.data.world){var u=e.data.world.transform;o.premultiply(u)}return r.transform.set(o.elements,16*t),n=a.readInt32(),r.frag2idx[t]=n,p(r.idx2frag,n,t),!0}function i(t,e){var r=o.getObject(t);return!!r&&(3===r.type&&n(t,e))}var s=e.worker,o=e.context,a=o.stream;return function(){var n=!1,a=o.getObjectCount(),u={materialIdx:null,mesh2frag:t.createDictionary(),frag2mesh:null,facets:null,frag2idx:null,idx2frag:null,bbox:null,transform:null,length:a},c=102*a,p=c?new ArrayBuffer(c):null,l=p?[p]:[];c&&(u.materialIdx=new Int32Array(p,0,a),u.frag2idx=new Int32Array(p,4*a,a),u.bbox=new Float32Array(p,8*a,6*a),u.transform=new Float32Array(p,32*a,16*a),u.frag2mesh=new Int32Array(p,96*a,a),u.facets=new Uint16Array(p,100*a,a),u.idx2frag=t.createDictionary());for(var f=h(e.package,e.packageType,3,p),y=0;y<a;++y)(d=i(y,u))||(n||(s.raiseError(2,"Bad Data",{url:e.url}),n=!0),t.sendMessage(e,f));if(e.data){if(e.data.fragments){var d=e.data.fragments;d.materialIdx=u.materialIdx,d.bbox=u.bbox,d.frag2idx=u.frag2idx,d.idx2frag=u.idx2frag,d.transform=u.transform,d.length=u.length,d.mesh2frag=u.mesh2frag,d.frag2mesh=u.frag2mesh}else e.data.fragments=u;u=null,p&&e.data.transferList.push(p),r(e)}else f.vbo=u,t.sendMessage(f,l);f=null,p=null,l=null}()}function d(e){function n(e){return e.world.up=l.readVector3f(),e.world.boundingBox=l.readBox(),e.world.transform=t.createMatrix4(!0),l.readArray(e.world.transform.elements,16),!0}function i(t){return t.camera.isPerspective=l.readBoolean(),t.camera.aspect=l.readFloat32(),t.camera.fov=l.readFloat32(),t.camera.orthoScale=l.readFloat32(),t.camera.position=l.readVector3f(),t.camera.target=l.readVector3f(),t.camera.up=l.readVector3f(),!0}function s(t){for(var e=l.readVarint(),r=0;r<e;++r)t.packages.push(l.readString());return!0}function o(t){for(var e=l.readVarint(),r=0;r<e;++r)t.uuids.push(l.readUniqueId());return!0}function a(t,e){var r=u.getObject(t);return!!r&&(10===r.type?n(e):0===r.type?i(e):9===r.type?s(e):8===r.type&&o(e))}var u=e.context,p=e.worker,l=u.stream;return function(){var n=!1,i=u.getObjectCount(),s=h(e.package,e.packageType,10),o=c();s.vbo=o;for(var l=0;l<i;++l)a(l,o)||(n||(p.raiseError(2,"Bad Data",{url:e.url}),n=!0),t.sendMessage(e,s));e.data?(e.data.world=o.world,e.data.camera=o.camera,e.data.packages=o.packages,e.data.uuids=o.uuids,r(e)):t.sendMessage(s),s=null,o=null}()}function m(e){function n(t,e,r,n,i,s){if(void 0===i&&(i=!1),void 0===s&&(s=!1),(r&n)===n){void 0===t[e]&&(t[e]={}),t[e].path=u.readString();var o=new Float32Array(9);u.readBoolean()?o.set([1,0,0,0,1,0,0,0,1]):u.readArray(o,9),t[e].transform=o,i&&(t[e].item1=u.readFloat32()),s&&(t[e].item2=u.readFloat32())}}function i(t,e){var r={name:"",color:0,shininess:0,opacity:0,transparency:!1};r.name=u.readString(),r.color=u.readInt32(),r.shininess=u.readInt32(),r.opacity=u.readFloat32(),r.transparency=r.opacity<1,r.reflectivity=u.readFloat32();var i=u.readUint8();4==(4&i)&&(r.emissive=u.readInt32()),8==(8&i)&&(r.specular=u.readInt32());var s=u.readUint16();return n(r,"map",s,1),n(r,"bumpMap",s,2,!0),n(r,"alphaMap",s,4),n(r,"normalMap",s,8,!0,!0),n(r,"aoMap",s,16,!0),n(r,"displacementMap",s,32,!0,!0),n(r,"emissiveMap",s,64,!0),n(r,"envMap",s,128),n(r,"lightMap",s,256,!0),n(r,"specularMap",s,512),r}function s(t,e,r){var n=a.getObject(t);return n&&7===n.type?i(e,r):null}var o=e.worker,a=e.context,u=a.stream;return function(){for(var n=!1,i=a.getObjectCount(),u=null,c=u?[u]:[],p=h(e.package,e.packageType,7,u),l=0,f=0;f<i;++f){var y=s(f,u,l);y?(l+=9,p.vbo[f]=y):(n||(o.raiseError(2,"Bad Data",{url:e.url}),n=!0),t.sendMessage(e,p))}e.data?(e.data.materials=p.vbo,u&&e.data.transferList.push(u),r(e)):t.sendMessage(p,c),u=null,c=null,p=null}()}function v(e){function n(t){for(var e=l.readVarint(),r=0;r<e;r++)t[r]=l.readString()}function i(t,e,r){for(var n=0,i=0,s=0,o=0;o<r;o++){t[o]=n,e[n++]=l.readVarint(),e[n++]=l.readVarint(),i=l.readVarint(),e[n++]=i;for(var a=0;a<i;a++){e[n++]=l.readVarint(),s=l.readVarint(),e[n++]=s;for(var u=0;u<s;u++)e[n++]=l.readVarint(),e[n++]=l.readVarint()}}}function s(t){n(t.names),n(t.types),n(t.category),n(t.keys),n(t.values);var e=l.readVarint(),r=l.getPosition();l.seek(8,2);var s=l.readUint32();l.seek(r,0);var o=s-r;return t.indices=new Uint32Array(e),t.pairs=new Uint32Array(o),i(t.indices,t.pairs,e),t}function o(){for(var t=l.readVarint(),e=[],r=0;r<t;r++){var n={name:l.readString(),height:l.readFloat32()};e.push(n)}return e}function a(){for(var t=l.readVarint(),e=[],r=0;r<t;r++){var n=l.readString(),i=l.readUint8(),s=void 0;2===i||0===i?((s=new Float32Array(2===i?7:6))[0]=l.readFloat32(),s[1]=l.readFloat32(),s[2]=l.readFloat32(),s[3]=l.readFloat32(),s[4]=l.readFloat32(),s[5]=l.readFloat32(),2===i&&(s[6]=l.readFloat32())):((s=new Float32Array(3===i?11:10))[0]=l.readFloat32(),s[1]=l.readFloat32(),s[2]=l.readFloat32(),s[3]=l.readFloat32(),s[4]=l.readFloat32(),s[5]=l.readFloat32(),s[6]=l.readFloat32(),s[7]=l.readFloat32(),s[8]=l.readFloat32(),s[9]=l.readFloat32(),3===i&&(s[10]=l.readFloat32()));var o={type:2===i||0===i?0:1,name:n,data:s};e.push(o)}return e}function u(t,e){var r=p.getObject(t);return r?11===r.type?s(e):12===r.type?o():13===r.type?a():null:null}var c=e.worker,p=e.context,l=p.stream;return function(){for(var n=!1,i=p.getObjectCount(),s={types:[],names:[],category:[],keys:[],values:[],indices:null,pairs:null},o=h(e.package,e.packageType,11),a=0;a<i;a++){var l=u(a,s);l?o.vbo[a]=l:(n||(c.raiseError(2,"Bad Data",{url:e.url}),n=!0),t.sendMessage(e,o))}if(e.data){e.data.attributes=o.vbo;var f=o.vbo;void 0!=f[0].keys&&e.data.transferList.push(f[0].indices.buffer,f[0].pairs.buffer),r(e)}else t.sendMessage(o)}()}t.load=e;var x=0,g=79}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";t.upload=function(t){}}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";t.search=function(t){}}(Nevm||(Nevm={}));var Nevm;!function(t){"use strict";function e(e){e.hasOwnProperty("action")&&t.route(e)}self.addEventListener("message",function(t){var r=t.data;r.worker=self,e(r)},!1)}(Nevm||(Nevm={}));